#### 評價選擇權的詳細指南

### 一、基本定價理論

1. **無套利原則**
   - 資產價格的預期變動應符合市場利率 $ r $，避免市場中存在無風險套利機會。
   - 公式：$ S_0 = e^{-r\Delta t} [p S_u + (1 - p) S_d] $

2. **風險中性評價法**
   - 假設投資者風險中性，只關心預期收益。
   - 風險中性概率：$ \tilde{p} = \frac{e^{r \Delta t} - d}{u - d} $
   - 期權現值：$ C_0 = e^{-r \Delta t} [\tilde{p} C_u + (1 - \tilde{p}) C_d] $
   - **使用時機**：適用於各種期權類型和不同市場條件，尤其是波動率和無風險利率變動或存在複雜的股息支付時。

3. **Black-Scholes公式**
   - 假設：
     - 標的資產價格服從幾何布朗運動。
     - 無風險利率和波動率為常數。
     - 不考慮提前行權（只適用於歐式期權）。
     - 不支付股息（或支付固定股息收益率的情況可以進行簡單修正）。
   - 公式：
     - 歐式看漲期權價格公式：$ C = S_0 N(d_1) - K e^{-rT} N(d_2) $
     - 歐式看跌期權價格公式：$ P = K e^{-rT} N(-d_2) - S_0 N(-d_1) $
     - $ d_1 = \frac{\ln(S_0/K) + (r + \sigma^2/2)T}{\sigma \sqrt{T}} $
     - $ d_2 = d_1 - \sigma \sqrt{T} $
   - **使用時機**：適用於標準的歐式期權，且市場條件符合Black-Scholes模型的假設，需快速計算期權價格時。

### 二、Put-Call平價關係

1. **歐式期權**
   - 平價公式：$ C + Ke^{-rT} = P + S_0 $
   - 檢驗看漲期權和看跌期權價格的合理性。

2. **美式期權**
   - 不等式公式：$ P_a - C_a \geq K - S_0 $
   - 反映美式期權提前行權的靈活性。

### 三、考慮股息的期權定價

1. **股息以股息收益率表示**
   - 歐式期權：使用調整後的Black-Scholes公式。
     - 看漲期權：$ C = S_0 e^{-qT} N(d_1) - K e^{-rT} N(d_2) $
     - 看跌期權：$ P = K e^{-rT} N(-d_2) - S_0 e^{-qT} N(-d_1) $
   - 美式期權：使用二項樹模型或數值方法。

2. **股息以現金金額的現值表示**
   - 歐式期權：調整標的資產價格。
     - 看漲期權：$ C = (S_0 - D) N(d_1) - K e^{-rT} N(d_2) $
     - 看跌期權：$ P = K e^{-rT} N(-d_2) - (S_0 - D) N(-d_1) $
   - 美式期權：數值方法計算，如二項樹模型。

### 四、使用CRR二項樹模型評價期權

1. **基本參數設置**
   - 時間步長：$ \Delta t = \frac{T}{N} $
   - 上升比例：$ u = e^{\sigma \sqrt{\Delta t}} $
   - 下降比例：$ d = \frac{1}{u} $
   - 風險中性概率：$ p = \frac{e^{r \Delta t} - d}{u - d} $

2. **構建資產價格樹**
   - 初始價格：$ S_0 $
   - 每個時間步的資產價格：$ S(i, j) = S_0 \cdot u^j \cdot d^{i-j} $

3. **計算期權價值**
   - 到期時的期權價值：
     - 看漲期權：$ C(i, j) = \max(S(i, j) - K, 0) $
     - 看跌期權：$ P(i, j) = \max(K - S(i, j), 0) $

   - 回溯計算：
     - 歐式期權：
       $ C(i, j) = e^{-r \Delta t} \left[ p \cdot C(i+1, j+1) + (1 - p) \cdot C(i+1, j) \right] $
       $ P(i, j) = e^{-r \Delta t} \left[ p \cdot P(i+1, j+1) + (1 - p) \cdot P(i+1, j) \right] $

     - 美式期權：
       $ C(i, j) = \max(S(i, j) - K, e^{-r \Delta t} [p \cdot C(i+1, j+1) + (1 - p) \cdot C(i+1, j)]) $
       $ P(i, j) = \max(K - S(i, j), e^{-r \Delta t} [p \cdot P(i+1, j+1) + (1 - p) \cdot P(i+1, j)]) $

4. **初始時間點的期權價格**
   - 初始價格：$ C(0, 0) $ 或 $ P(0, 0) $ 即為所求的期權價格。
